"use strict";(self.webpackChunkfrosted_by_nes=self.webpackChunkfrosted_by_nes||[]).push([[78],{2337:(e,t,s)=>{s.r(t),s.d(t,{Aggregate:()=>f});var n=s(4572),i=s(3973),r=s(8038),a=s(4613),h=s(7661),o=s(8575),c=s(8958),d=s(8214),u=s(3980),v=s(1527);class f extends v.m{constructor(e,t){var s;super(e,t,d.t),s=this,this.eventsPerMinute=240,this.harvestTimeSeconds=(0,c.Mt)(this.agentIdentifier,"page_action.harvestTimeSeconds")||(0,c.Mt)(this.agentIdentifier,"ins.harvestTimeSeconds")||30,this.eventsPerHarvest=this.eventsPerMinute*this.harvestTimeSeconds/60,this.referrerUrl=void 0,this.currentEvents=void 0,this.events=[],this.att=(0,c.C5)(this.agentIdentifier).jsAttributes,u.il&&document.referrer&&(this.referrerUrl=(0,o.f)(document.referrer)),(0,a.X)("api-addPageAction",(function(){return s.addPageAction(...arguments)}),this.featureName,this.ee),this.waitForFlags(["ins"]).then((e=>{let[t]=e;if(t){const e=new h.o("ins",{onFinished:function(){return s.onHarvestFinished(...arguments)}},this);e.harvest.on("ins",(function(){return s.onHarvestStarted(...arguments)})),e.startTimer(this.harvestTimeSeconds,0)}else this.blocked=!0})),this.drain()}onHarvestStarted(e){const{userAttributes:t,atts:s}=(0,c.C5)(this.agentIdentifier);var n={qs:{ua:t,at:s},body:{ins:this.events}};return e.retry&&(this.currentEvents=this.events),this.events=[],n}onHarvestFinished(e){e&&e.sent&&e.retry&&this.currentEvents&&(this.events=this.events.concat(this.currentEvents),this.currentEvents=null)}addPageAction(e,t,s){if(!(this.events.length>=this.eventsPerHarvest||this.blocked)){var n,a,h={};u.il&&window.document.documentElement&&(n=window.document.documentElement.clientWidth,a=window.document.documentElement.clientHeight);var d={timestamp:e+(0,c.OP)(this.agentIdentifier).offset,timeSinceLoad:e/1e3,browserWidth:n,browserHeight:a,referrerUrl:this.referrerUrl,currentUrl:(0,o.f)(""+location),pageUrl:(0,o.f)((0,c.OP)(this.agentIdentifier).origin),eventType:"PageAction"};(0,i.D)(d,v),(0,i.D)((0,c.C5)(this.agentIdentifier).jsAttributes,v),s&&"object"===typeof s&&(0,i.D)(s,v),h.actionName=t||"",this.events.push(h)}function v(e,t){h[e]=t&&"object"===typeof t?(0,r.P)(t):t}}}(0,n.Z)(f,"featureName",d.t)}}]);
//# sourceMappingURL=page_action-aggregate.123f8d5e.chunk.js.map